# kiwoom-api-32bit

# 키움증권 1분 주가 데이터 수집기 (2024년 11월 MSCI 편입 종목 기준)

이 프로젝트는 **2024년 11월 기준 MSCI 편입 종목**의 **1분 단위 주가 데이터**를 키움증권 OpenAPI를 통해 수집하고, 해당 데이터를 **MySQL 데이터베이스에 저장**하는 자동화 도구입니다.

## 🔧 기술 스택 및 환경

- Python (32bit 환경)
- Kiwoom OpenAPI+ (OCX 기반)
- MySQL
- PyQt5 / pythoncom (키움 API 연동)
- REST 방식 (추후 확장 가능)

> 📌 현재 코드는 OCX 기반이나, 키움증권이 REST 방식을 공식 지원함에 따라 향후 REST 기반으로 전환하는 것이 훨씬 더 편리하고 효과적입니다.

---

## 📁 파일 구성

| 파일명 | 설명 |
|--------|------|
| `activation.py` | **사용자가 지정한 SQL DB에 1분 단위 데이터 수집 및 저장**을 수행하는 메인 스크립트입니다. |
| `auto_login_activation.py` | 실행 시 **자동 로그인 기능**을 포함한 버전으로, 매번 수동 로그인 없이 실행이 가능합니다. |
| `database.py` | MySQL **데이터베이스 연결 및 저장 로직**을 담당합니다. |
| `one_minute.py` | 실시간이 아닌 **1분 단위 가격 데이터**를 수집하기 위한 로직이 구현되어 있습니다. |
| `real_time_data.py` | **실시간 주가 정보 수신**을 시도한 코드이며, 실제로 동작하지만 개인 프로젝트에서는 사용하지 않았습니다. (코드 실행 가능) |

---

## 🛠 설치 및 실행 방법

1. **Python 32bit 설치 필수**
2. 필요한 패키지 설치
    ```bash
    pip install pyqt5 pymysql pythoncom
    ```
3. 키움증권 OpenAPI+ 설치 (hts 또는 홈페이지 통해)
4. `database.py`에 **DB 접속 정보 설정**
5. `activation.py` 실행
    ```bash
    python activation.py
    ```

---

## ⚠️ 참고 사항

- 키움 OpenAPI는 반드시 **Windows 환경**에서 실행되어야 하며, **32bit Python**만 지원합니다.
- 키움증권 로그인을 위한 공인인증서 또는 인증수단이 사전에 등록되어 있어야 합니다.
- 향후 REST API 방식 전환 시, 더 안정적인 운영이 가능하므로 권장됩니다.

---

## 📌 향후 계획

- REST API 방식으로 전환
- 종목 자동 필터링 기능 추가
- 다중 종목 병렬 수집 최적화

---

## 📜 라이선스

본 프로젝트는 학습 및 개인 프로젝트 목적에 한해 자유롭게 사용할 수 있습니다.
